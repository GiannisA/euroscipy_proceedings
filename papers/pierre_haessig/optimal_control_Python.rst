:author: Pierre Haessig
:email: pierre.haessig@bretagne.ens-cachan.fr
:institution: SATIE laboratory - ENS Cachan Bretagne, Bruz, France

:author: Thibaut Kovaltchouk
:institution: SATIE laboratory - ENS Cachan Bretagne, Bruz, France

:author: Bernard Multon
:institution: SATIE laboratory - ENS Cachan Bretagne, Bruz, France

:author: Hamid Ben Ahmed
:institution: SATIE laboratory - ENS Cachan Bretagne, Bruz, France

:author: Stéphane Lascaud
:institution: LME department - EDF R&D, Écuelles, France


=========================================================
Computing an Optimal Control Policy for an Energy Storage
=========================================================

.. class:: abstract

    We introduce StoDynProg, a small library created to solve Optimal
    Control problems arising in the management of Renewable Power Sources,
    in particular when coupled with an Energy Storage System. The library
    implements generic Stochastic Dynamic Programming (SDP) numerical
    methods which can solve a large class of Dynamic Optimization problems.

    We demonstrate the library capabilities with a prototype problem:
    smoothing the power of an Ocean Wave Energy Converter. First we use time
    series analysis to derive a stochastic Markovian model of this system
    since it is required by Dynamic Programming. Then, we briefly describe
    the “policy iteration” algorithm we have implemented and the numerical
    tools being used. We show how the API design of the library is generic
    enough to address Dynamic Optimization problems outside the field of
    Energy Management. Finally, we solve the power smoothing problem and
    compare the optimal control with a simpler heuristic control.


.. class:: keywords

   Stochastic Dynamic Programming, Policy Iteration Algorithm,
   Autoregressive Models, Ocean Wave Energy, Power Smoothing.

Introduction to Power Production Smoothing
==========================================

Electric power generated by renewable
sources like wind, sun or ocean waves can exhibit a strong *variability*
along time. Because on an electricity grid the energy production must
match the consumption, this variability can be an issue for the grid
stability. Yet most of the time, fluctuations of renewable power sources
are absorbed without trouble thanks to regulation mechanisms which make
flexible generation units adjust their production in real-time.
Therefore, the production-consumption equilibrium can be maintained.

However, there are cases where fluctuations may be considered too strong
to be fed directly to the grid so that an *energy storage system*,
acting a *buffer*, may be required to smooth out the production. The
schematic of the system considered in this article is given on figure
:ref:`smoothing-diagram`.


.. figure:: searev_storage.pdf
   :figclass: t
   
   Power smoothing with an Energy Storage: an example of an Optimal Control problem. :label:`smoothing-diagram`


Full article
============

Due to manuscript conversion issues, only the introduction of the manuscript
is available here, along with all figures.
The full article may be found on http://publications.pierreh.eu as a PDF file.


.. figure:: power_smoothing_linear.pdf
    
    Smoothing the Ocean Power injected to the grid using an Energy Storage
    controlled by the simple linear law.
    The storage buffers the difference between the two powers.


.. figure:: speed_acf_AR2.pdf

    Autocorrelation (acf) of the speed data,
    compared with the acf from two AR(2) models,
    fitted with two different methods.


.. figure:: speed_power_Em1.pdf
    :figclass: w
    :scale: 70%
    
    Speed & Power time series from a 1000 seconds SEAREV simulation (sample Em_1.txt).
    The gray rectangle time interval is enlarged in the middle panel.
    Distribution histogram on the right.

.. figure:: P_grid_law.png


   Storage control policy: Power injected to the grid as
   a function of speed and acceleration,
   for 7 levels of stored energy between empty and full.


.. figure:: storage_policy_comparison_annot.pdf
    :figclass: w
    :scale: 70%
    
    Comparison of the power smoothing behavior between
    the *heuristic* (dark blue) and *optimized* (light blue)
    storage management policies (storage capacity of 10 MJ).
    Stored energy on the bottom panel.
    
.. figure:: control_benefits.pdf
    :scale: 60%
    
    Effect of optimizing the storage control on three SEAREV
    production time series.
    Standard deviation compared to the heuristic linear control case
    is reduced by about 20 %.
